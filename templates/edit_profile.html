{% extends "base_layout.html" %}

{% block title %}プロフィール編集{% endblock %}

{% block content %}
    <h1>プロフィール編集</h1>
    <form method="POST" enctype="multipart/form-data">
        {{ form.csrf_token }}
        <div class="form-field">
            {{ form.username.label }}<br>
            {{ form.username(size=20) }}
            {% for error in form.username.errors %}
                <span style="color: red;">[{{ error }}]</span>
            {% endfor %}
        </div>

        <div class="form-field">
            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 0.5em;">
                <label for="bio">{{ form.bio.label }}</label>
                <a href="javascript:void(0)" id="toggle-tag-form-btn" title="タグを編集">
                    <img src="{{ url_for('static', filename='icons/ei-tag.png') }}" alt="タグ" style="width: 24px; height: 24px; vertical-align: middle;">
                </a>
            </div>
            {{ form.bio(cols=40, rows=5) }}
        </div>

        <div id="tag-form-container" class="form-field hidden" style="position: relative;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5em;">
                <label for="tags-input-field">タグ (カンマ区切りで入力)</label>
                <a href="javascript:void(0)" id="recent-tags-toggle" title="最近使用したタグ">
                    <img src="{{ url_for('static', filename='icons/underdir.png') }}" alt="最近のタグ" style="width: 20px; height: 20px;">
                </a>
            </div>
            <div id="recent-tags-list" class="recent-tags-dropdown hidden">
                </div>
            {{ form.tags(id="tags-input-field", placeholder="例: 1クラス, 情シ, B4") }}
        </div>
        <div class="form-field">
            {{ form.icon.label }}<br>
            {{ form.icon(accept="image/jpeg, image/png, image/gif") }}
            {% if current_user.icon_url %}
                <br>現在のアイコン: <img src="{{ current_user.icon_url }}" alt="現在のアイコン" style="width: 50px; height: 50px; border-radius: 50%;">
            {% endif %}
            {% for error in form.icon.errors %}
                <span style="color: red;">[{{ error }}]</span>
            {% endfor %}
        </div>
        {{ form.submit }}
    </form>
{% endblock %}