{% extends "base_layout.html" %}

{% block title %}設定{% endblock %}

{% block content %}
    <div class="post-form">
        <h2>設定</h2>
        
        <div id="notification-settings-toggle" style="cursor: pointer; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--border-color); padding-bottom: 0.5em;">
            <h3 style="margin-top: 0; margin-bottom: 0;">通知の基本設定</h3>
            <span id="toggle-icon" style="font-size: 1.2em;">
                {% if settings_open %}△{% else %}▽{% endif %}
            </span>
        </div>
        
        <div id="notification-settings-content" class="{% if not settings_open %}hidden{% endif %}" style="margin-top: 1.5em;">

            <p style="font-size: 0.9em; color: var(--text-muted); margin-top: 0;">
                サイト全体でプッシュ通知を受け取るか
            </p>
            <form method="POST">
                {{ form.csrf_token }}
                <div class="form-field" style="display: flex; align-items: center; gap: 10px; margin-bottom: 1.5em; background: none; border: none; box-shadow: none; padding: 0;">
                    {{ form.enable_push(style="width: auto; height: auto;") }}
                    {{ form.enable_push.label(style="margin: 0; font-weight: normal;") }}
                </div>
                
                <p style="font-size: 0.8em; color: var(--text-muted); margin-top: -1em; margin-bottom: 1.5em;">
                    チェックを外すと、すべてのデバイスでのプッシュ通知が停止
                </p>
                {{ form.submit() }}
            </form>

           
            
            <hr style="margin: 2em 0;">
            
            <h3>プッシュ通知の管理 (このブラウザ)</h3>
            
            <p style="font-size: 0.9em; color: var(--text-muted);">
                現在、新しい通知システムの準備中です。
            </p>
        
        </div>
    </div>
{% endblock %}


{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {

    // --- 設定ページのトグル機能 ---
    const settingsToggle = document.getElementById('notification-settings-toggle');
    const settingsContent = document.getElementById('notification-settings-content');
    const toggleIcon = document.getElementById('toggle-icon');

    if (settingsToggle && settingsContent && toggleIcon) {
        settingsToggle.addEventListener('click', function() {
            const isHidden = settingsContent.classList.toggle('hidden');
            toggleIcon.textContent = isHidden ? '▽' : '△';
        });
    }

});
</script>
{% endblock %}